<!doctype html>
<html lang="zh-Hant">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover,maximum-scale=1,user-scalable=no" />
    <title>ğŸ“„ å‹å ±å»ºæª”è¡¨</title>

    <style>
        :root {
            /* -----------GASéƒ¨ç½²ç¶²å€å†890è¡Œ------------ */
            /* --------ç³»çµ±å…±ç”¨å¸¸æ•¸ï¼ˆå¯èª¿ï¼‰-------- */
            --card-w: 980px;       /* è¡¨å–®é¢æ¿æœ€å¤§å¯¬åº¦ï¼ˆå¯èª¿ï¼‰ */
            --radius: 16px;        /* é¢æ¿åœ“è§’ï¼ˆå¯èª¿ï¼‰ */
            --border: #2a2a2a;     /* é‚Šæ¡†è‰²ï¼ˆå¯èª¿ï¼‰ */
            --ink: #eaeaea;        /* ä¸»è¦æ–‡å­—è‰²ï¼ˆå¯èª¿ï¼‰ */
            --muted: #959595;      /* æ¬¡è¦æ–‡å­—è‰²ï¼ˆèˆ‡ â åŒè‰²ï¼‰ */
            --danger: #fff2cc;     /* éŒ¯èª¤è‰²ï¼ˆå¯èª¿ï¼›é»ƒè‰²ï¼‰ */
            --ok: #22c55e;         /* æˆåŠŸ/é€šéè‰²ï¼ˆå¯èª¿ï¼‰ */
            --accent: #60a5fa;     /* é‡é»è‰²/èšç„¦é‚Šæ¡†ï¼ˆå¯èª¿ï¼‰ */
            --btn-bg: #bc2d2d;     /* æŒ‰éˆ•åº•è‰²ï¼ˆå¯èª¿ï¼‰ */
            --btn-border: #2a2a2a; /* æŒ‰éˆ•é‚Šæ¡†ï¼ˆå¯èª¿ï¼‰ */

            --title-size: 24px;    /* ä¸Šæ–¹é é¢ä¸»æ¨™é¡Œå­—ç´šï¼ˆå¯èª¿ï¼‰ */
            --content-size: 12px;  /* å¯†ç¢¼ä¹‹ç¢ºå®šã€é æ•¸ã€ä¸Šä¸‹ä¸€é ï¼ˆå¯èª¿ï¼‰ */
            --footer-size: 12px;   /* å•†æ¨™ï¼›ç‰ˆæ¬Šï¼ˆå¯èª¿ï¼‰ */

            /* --------å…¨åŸŸå­—ç´šæ§åˆ¶è®Šæ•¸ï¼ˆå¯èª¿ï¼‰--------*/
            --label-size: 15px;        /* æ¬„ä½æ¨™é¡Œå­—ç´šï¼ˆä¾‹å¦‚ï¼šå…¬å¸åç¨±ï¼›å¯èª¿ï¼‰ */
            --hint-size: 11px;         /* å°å­—æç¤ºï¼ˆlabel smallï¼›å¯èª¿ï¼‰ */
            --input-size: 14px;        /* è¼¸å…¥æ¡†/é¸å–®å…§æ–‡å­—å­—ç´šï¼ˆå¯èª¿ï¼‰ */
            --placeholder-size: 14px;  /* placeholder å­—ç´šï¼ˆå¯èª¿ï¼‰ */
            --error-size: 14px;        /* éŒ¯èª¤è¨Šæ¯å­—ç´šï¼ˆå¯èª¿ï¼‰ */

            --section-gap: 16px;       /* å€å¡Šèˆ‡æ®µè½é–“è·ï¼ˆå¯èª¿ï¼‰ */
            --control-pad: 10px 12px;  /* æ§åˆ¶é …å…§è·ï¼ˆå¯èª¿ï¼‰ */
            --control-radius: 12px;    /* æ§åˆ¶é …åœ“è§’ï¼ˆå¯èª¿ï¼‰ */
            --control-bg: #0f0f0f;     /* æ§åˆ¶é …èƒŒæ™¯ï¼ˆå¯èª¿ï¼‰ */
            --control-border: #262626; /* æ§åˆ¶é …é‚Šæ¡†ï¼ˆå¯èª¿ï¼‰ */
            --control-focus: #60a5fa;  /* æ§åˆ¶é …èšç„¦å¤–æ¡†è‰²ï¼ˆå¯èª¿ï¼‰ */

            --input-height: 38px;      /* æ§åˆ¶é …é«˜åº¦ï¼ˆè®“æ¡†æ¡†åŒé«˜ï¼›å¯èª¿ï¼‰ */

            --actionbar-h: 64px;       /* åº•éƒ¨å›ºå®šæ“ä½œåˆ—é«˜åº¦ï¼ˆå¯èª¿ï¼›JS è¦†è“‹å¯¦éš›é«˜åº¦ï¼‰ */
            --footer-h: 44px;          /* é å°¾é«˜åº¦ï¼ˆå¯èª¿ï¼‰ */
            --kv-offset: 0px;          /* éµç›¤å½ˆå‡ºæ™‚å‘ä¸Šä½ç§»é‡ï¼ˆJS å¯«å…¥ï¼‰ */

            /* -----------å­—ç´šçµ±æ•´æ¨¡çµ„ åŒæ„ï¼›æœ‰ç•°è­°----------- */
            --fz-title: 28px;          /* â˜… å¤§æ¨™é¡Œï¼ˆæ­¥é©Ÿåç¨±ã€é é¢å¤§æ¨™ï¼‰ */
            --fz-subtitle: 22px;       /* â˜… ç¬¬äºŒå±¤æ¨™é¡Œï¼ˆå€å¡Šåç¨±ã€å­æ¨™é¡Œï¼‰ */
            --fz-section: 20px;        /* â˜… å€æ®µèªªæ˜ï¼ˆå¤šç”¨æ–¼æ®µè½æ¨™èªã€ç« ç¯€é–‹å ´ï¼‰ */
            --fz-body: 18px;           /* â˜… å…§æ–‡æ­£æ–‡ï¼ˆæ•´ä»½è¡¨å–®æœ€å¸¸ç”¨çš„å­—ï¼‰ */
            --fz-note: 16px;           /* â˜… å‚™è¨»ã€å°æç¤ºã€æ¢æ–‡ï¼ˆä¾‹å¦‚ï¼šäº†è§£ æœ‰ç•°è­°ï¼‰ */
            --fz-xs: 14px;             /* â˜… ç‰¹å°å­—ï¼ˆå¾ˆå°‘ç”¨ï¼Œé€šå¸¸æ˜¯è£œå……æˆ–ç‰ˆæ¬Šï¼‰ */

            /* ä¸Šä¸€é /ä¸‹ä¸€é ç¸®å°ç”¨ï¼ˆå¯èª¿ï¼‰ */
            --nav-btn-min-h: 32px;     /* åªå½±éŸ¿ã€Œä¸Šä¸€é  / ä¸‹ä¸€é ã€å…©é¡†æŒ‰éˆ•çš„æœ€å°é«˜åº¦ï¼ˆå¯èª¿ï¼‰ */
            --nav-btn-pad: 4px 10px;   /* åªå½±éŸ¿ã€Œä¸Šä¸€é  / ä¸‹ä¸€é ã€å…©é¡†æŒ‰éˆ•çš„å…§è·ï¼ˆå¯èª¿ï¼‰ */

            /* æ“ä½œåˆ—å…§è·ï¼ˆå¯èª¿ï¼Œç¸®å°æ•´åˆ—é«˜åº¦ï¼‰ */
            --actionbar-pad-y: 6px;    /* æ“ä½œåˆ—ä¸Šä¸‹å…§è·ï¼ˆå¯èª¿ï¼‰ */
            --actionbar-pad-x: 12px;   /* æ“ä½œåˆ—å·¦å³å…§è·ï¼ˆå¯èª¿ï¼‰ */

            /* é¢æ¿èƒŒæ™¯è®Šæ•¸ï¼ˆç”± data-* æ§åˆ¶ï¼‰ */
            --panel-bg: linear-gradient(0deg,rgba(43,37,37,1) 0%, rgba(0,0,0,1) 100%); /* é è¨­é»‘ */

            /* --------ç¬¬4é ï¼šç¯„ä¾‹åœ–ç‰‡å°ºå¯¸/å¤–è§€ï¼ˆå¯èª¿ï¼‰--------*/
            --sample-gap: 10px;                  /* åœ–ç‰‡ä¹‹é–“çš„é–“è·ï¼ˆå¯èª¿ï¼‰ */
            --sample-max-h: 180px;               /* åœ–ç‰‡æœ€å¤§é«˜åº¦ï¼ˆå¯èª¿ï¼‰ */
            --sample-pad: 8px;                   /* æ¯å¼µåœ–å¤–æ¡†å…§è·ï¼ˆå¯èª¿ï¼‰ */
            --sample-bg: rgba(255,255,255,0.04); /* åœ–ç‰‡å¤–æ¡†åº•è‰²ï¼ˆå¯èª¿ï¼‰ */
            --sample-radius: 12px;               /* åœ–ç‰‡å¤–æ¡†åœ“è§’ï¼ˆå¯èª¿ï¼‰ */
        }

        /* --------é¸å–®å­—é«”å¤§å°èª¿æ•´ï¼ˆæ‰€æœ‰é¸å–®ï¼‰-------- */
        select {
            font-size: 14px !important; /* èª¿å°æ‰€æœ‰é¸å–®çš„å­—é«” */
        }

        /* ----------çµ±ä¸€å­—ç´š------------ */
        .fz-title {
            font-size: var(--fz-title);
        }

        .fz-subtitle {
            font-size: var(--fz-subtitle);
        }

        .fz-section {
            font-size: var(--fz-section);
        }

        .fz-body {
            font-size: var(--fz-body);
        }

        .fz-note {
            font-size: var(--fz-note);
        }

        .fz-xs {
            font-size: var(--fz-xs);
        }

        /* ===== å…¨ç«™èƒŒæ™¯åº•è‰² ===== */
        html, body {
            height: 100%;
            margin: 0;
            overflow: hidden; /* é–å®šå¤–éƒ¨å·è»¸ï¼Œåªè®“å…§éƒ¨ Flex æ»¾å‹• */
        }

        body {
            font-family: "GenSenRounded", "Yuanti TC", "Hiragino Maru Gothic ProN", "M PLUS Rounded 1c", "PingFang TC", "Noto Sans TC", "Microsoft JhengHei", "Segoe UI", Arial, sans-serif;
            color: var(--ink);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
            touch-action: pan-y; /* åƒ…å…è¨±å‚ç›´æ»‘å‹• */
            overscroll-behavior-y: contain; /* æŠ‘åˆ¶å½ˆæ€§å›å½ˆå¹²æ“¾ */
            background: #000; /* èƒŒæ™¯åº•è‰²ï¼ˆé¢æ¿æ¼¸å±¤æœƒè¦†è“‹ï¼‰ */
        }

        /* ===== é¢æ¿ï¼ˆä¸Šä¸‹è²¼é½Šã€å…§å®¹å…§æ²ã€å›ºå®šåº•éƒ¨æ“ä½œåˆ— + é å°¾ï¼‰===== */
        .container {
            width: min(var(--card-w), 100vw);
            height: 100svh; /* ä½¿ç”¨ svhï¼Œå—è¦–å£å¯è¦–é«˜åº¦å½±éŸ¿ï¼Œéµç›¤å½ˆå‡ºæ›´ç©©å®š */
            margin: 0 auto;
            border: 1px solid var(--border);
            border-radius: var(--radius);
            box-shadow: 0 12px 28px rgba(0,0,0,0.35);
            display: flex;
            flex-direction: column;
            overflow: hidden;
            background: var(--panel-bg) !important; /* ä»¥è®Šæ•¸ç‚ºæœ€çµ‚èƒŒæ™¯ */
        }

            /* ===== ç”¨ data-scheme æ§åˆ¶é»‘/ç´«å…©ç¨®åº•è‰² ===== */
            .container[data-scheme="black"] {
                --panel-bg: linear-gradient(0deg,rgba(43,37,37,1) 0%, rgba(0,0,0,1) 100%);
            }

            .container[data-scheme="purple"] {
                --panel-bg: linear-gradient(0deg,rgba(105,30,61,1) 0%, rgba(75,14,61,1) 83%, rgba(56,4,61,1) 100%);
            }

        /* é é¦–ï¼ˆä¸­é–“ç½®ä¸­æ¨™é¡Œï¼›å³ä¸Šè§’é¡¯ç¤ºæ­¥é©Ÿï¼‰ */
        .header {
            flex-shrink: 0; /* é˜²æ­¢è¢«å£“ç¸® */
            position: relative;
            padding: 12px 16px;
            border-bottom: 1px solid var(--border);
            backdrop-filter: blur(2px);
        }

        .header-title {
            font-weight: 900; /* è¦ç²—é«” */
            font-size: var(--title-size);
            text-align: center;
            letter-spacing: 0.5px;
            text-shadow: 0 1px 0 rgba(0,0,0,.6), 0 0 8px rgba(0,0,0,.35);
        }

        .header-step {
            position: absolute;
            right: 12px;
            top: 20px;
            color: var(--muted);
            font-size: var(--content-size);
            font-weight: 700;
        }

        /* =====åªåœ¨æ­¤å€æ»¾å‹•ï¼›åº•éƒ¨é ç•™æ“ä½œåˆ—èˆ‡é å°¾é«˜åº¦ ===== */
        .content {
            flex: 1;
            min-height: 0;
            padding: 16px;
            overflow-y: auto;
            -webkit-overflow-scrolling: touch;
            touch-action: pan-y; /* å¼·åŒ– iOS è§¸æ§åˆ¤å®š */
            padding-bottom: calc(var(--actionbar-h) + var(--footer-h) + 16px);
        }

        /* æ­¥é©Ÿé  */
        .step {
            display: none;
            font-size: var(--content-size);
        }

            .step.active {
                display: block;
            }

            .step h2 {
                margin: 0 0 10px 0;
                font-size: var(--title-size);
                text-align: center;
                font-weight: 800;
            }

            /* æŒ‡å®šå¹¾é æ¨™é¡Œé å·¦ï¼ˆæœ‰é©šå˜†è™Ÿé‚£å¹¾é ï¼‰ */
            .step[data-page="1"] h2, .step[data-page="2"] h2, .step[data-page="3"] h2,
            .step[data-page="4"] h2, .step[data-page="6"] h2 {
                text-align: left !important;
            }

        .note-list {
            margin: 8px 0 16px 1.2em;
            color: var(--muted);
            line-height: 1.7;
            font-size: 15px !important;
        }

            .note-list p {
                margin-top: 0px;
                margin-bottom: 12px;
            }

        .fieldset {
            border: 1px dashed var(--border);
            border-radius: var(--control-radius);
            padding: 14px;
            margin-top: var(--section-gap);
        }

        /* ç¬¬1é ï¼šæ•´çµ„ç½®ä¸­ + é¸é …ç½®ä¸­ */
        .center-block {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
            gap: 12px;
        }

        .radio-row {
            display: flex;
            justify-content: center;
            gap: 18px;
            flex-wrap: wrap;
        }

        .exit {
            background: rgba(250, 204, 21, .10);
            border: 1px solid rgba(250, 204, 21, .45);
            color: #fde68a;
            padding: 12px;
            border-radius: 12px;
            margin-top: 8px;
            display: none;
        }

            .exit.show {
                display: block;
            }

        /* è¡¨å–®æ§åˆ¶é …ï¼ˆçµ±ä¸€å¯¬é«˜ + èˆ‡ â åŒè‰²ï¼‰ */
        label {
            font-weight: 700;
            display: block;
            margin-bottom: 6px;
            font-size: var(--label-size, var(--content-size));
        }

            label small {
                color: var(--muted);
                font-weight: 600;
                margin-left: 4px;
                font-size: var(--hint-size, var(--content-size));
            }

        .row {
            margin-bottom: var(--section-gap);
        }

        input[type="text"], input[type="email"], select {
            width: 100%;
            padding: var(--control-pad);
            background: var(--control-bg);
            border: 1px solid var(--control-border);
            border-radius: var(--control-radius);
            outline: none;
            color: var(--muted) !important;
            font-size: var(--input-size);
            height: var(--input-height);
            box-sizing: border-box;
        }

        input::placeholder {
            font-size: var(--placeholder-size);
            color: var(--muted);
        }

        input:focus, select:focus {
            border-color: var(--control-focus);
            box-shadow: 0 0 0 3px rgba(96,165,250,.25);
        }

        .error {
            color: var(--danger);
            margin-top: 6px;
            font-size: var(--error-size);
            display: none;
        }

        .radio-row label {
            font-size: var(--content-size);
            font-weight: 700;
        }

        /* iOS Safariï¼šé¿å…èšç„¦è‡ªå‹•æ”¾å¤§ */
        @supports (-webkit-touch-callout: none) {
            input[type="text"]:focus, input[type="email"]:focus, select:focus {
                font-size: 16px !important;
            }
        }

        select {
            font-size: var(--input-size) !important;
            color: var(--muted) !important;
        }

        /* æª”æ¡ˆä¸Šå‚³ï¼ˆåŒä¸€æ’é¡¯ç¤ºç¸®åœ–ï¼‰ */
        .file-row {
            display: grid;
            grid-template-columns: 1fr auto 1.2fr;
            gap: 10px;
            align-items: center;
            margin-bottom: var(--section-gap);
        }

        .file-name {
            color: var(--muted);
            font-size: var(--content-size);
            min-height: var(--input-height);
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 0 6px;
            border: 1px dashed var(--control-border);
            border-radius: var(--control-radius);
            background: rgba(255,255,255,0.02);
            box-sizing: border-box;
            overflow: hidden;
        }

        .thumb {
            width: 48px;
            height: 32px;
            object-fit: cover;
            border-radius: 6px;
            display: none;
        }

        .file-input {
            position: relative;
            overflow: hidden;
            display: inline-block;
        }

            .file-input input[type="file"] {
                position: absolute;
                inset: 0;
                opacity: 0;
                cursor: pointer;
            }

        .file-btn {
            appearance: none;
            border: 1px solid var(--btn-border);
            background: var(--btn-bg);
            color: var(--ink);
            padding: 10px 14px;
            border-radius: 12px;
            font-weight: 800;
            cursor: pointer;
            font-size: var(--content-size);
            min-height: var(--input-height);
            display: inline-flex;
            align-items: center;
        }

        .btn--nav {
            min-height: var(--nav-btn-min-h);
            padding: var(--nav-btn-pad);
        }

        /* åº•éƒ¨å›ºå®šæ“ä½œåˆ—ï¼ˆå…¨é å…±ç”¨ï¼‰ */
        .actionbar {
            flex-shrink: 0; /* é˜²æ­¢è¢«å£“ç¸® */
            position: relative;
            display: flex;
            gap: 10px;
            justify-content: space-between;
            align-items: center;
            padding: var(--actionbar-pad-y) var(--actionbar-pad-x) calc(var(--actionbar-pad-y) + env(safe-area-inset-bottom));
            border-top: 1px solid var(--border);
            background: rgba(0,0,0,0.35);
            backdrop-filter: blur(4px);
            height: auto;
            transform: translateY(calc(-1 * var(--kv-offset)));
            transition: opacity .18s ease;
        }

        .btn {
            appearance: none;
            border: 1px solid var(--btn-border);
            background: var(--btn-bg);
            color: var(--ink);
            padding: 10px 14px;
            border-radius: 12px;
            font-weight: 800;
            cursor: pointer;
            font-size: var(--content-size);
            min-height: var(--input-height);
        }

            .btn:disabled {
                opacity: .55;
                cursor: not-allowed;
            }

        /* Sticky Footerï¼ˆæ¯é éƒ½æœƒçœ‹åˆ°ï¼‰ */
        .footer {
            flex-shrink: 0; /* é˜²æ­¢è¢«å£“ç¸® */
            border-top: 1px solid var(--border);
            padding: 10px 14px calc(10px + env(safe-area-inset-bottom));
            text-align: center;
            color: var(--muted);
            font-size: var(--footer-size);
            background: rgba(0,0,0,0.15);
            height: var(--footer-h);
            transform: translateY(calc(-1 * var(--kv-offset)));
        }

        .footer-logo {
            height: 25px;
            width: auto;
            vertical-align: middle;
            margin-right: 6px;
        }

        /* éµç›¤é–‹å•Ÿæ™‚ï¼šéš±è—åº•éƒ¨æ“ä½œåˆ— */
        body.kb-open .actionbar {
            opacity: 0;
            pointer-events: none;
            transform: translateY(0) !important;
        }

        body.kb-open .content {
            padding-bottom: calc(var(--footer-h) + 16px);
        }

        /* ========== æ¯é ç¨ç«‹è¨­å®šå€ï¼ˆå¯é€é è¦†è“‹ï¼›å­—ç´šï¼‰ ========== */
        .step[data-page="1"] {
            --title-size: 18px;
            --content-size: 12px;
        }

        .step[data-page="2"] {
            --title-size: 18px;
            --content-size: 12px;
        }

        .step[data-page="3"] {
            --title-size: 18px;
            --content-size: 12px;
        }

        .step[data-page="4"] {
            --title-size: 18px;
            --content-size: 12px;
        }

        .step[data-page="5"] {
            --title-size: 18px;
            --content-size: 12px;
        }

        .step[data-page="6"] {
            --title-size: 18px;
            --content-size: 12px;
        }

        .step[data-page="7"] {
            --title-size: 18px;
            --content-size: 12px;
        }

        .step[data-page="8"] {
            --title-size: 18px;
            --content-size: 12px;
        }

        /* ç¬¬4é ï¼šç¯„ä¾‹åœ–ç‰‡æ”¹ä¸Šä¸‹ */
        #step-4 .samples {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--sample-gap);
            align-items: start;
            margin-top: 10px;
        }

        #step-4 .sample-box {
            background: var(--sample-bg);
            border: 1px dashed var(--control-border);
            border-radius: var(--sample-radius);
            padding: var(--sample-pad);
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        #step-4 .sample-img {
            width: 100%;
            height: var(--sample-max-h);
            object-fit: contain;
            image-rendering: auto;
        }

        #step-4 .sample-cap {
            margin-top: 6px;
            font-size: var(--content-size);
            color: var(--muted);
            text-align: center;
        }

        #step-4 .file-name {
            display: flex;
            flex-direction: column;
            align-items: center;
            text-align: center;
        }

            #step-4 .file-name .thumb {
                display: block;
                margin: 0 auto;
            }

/* ====== ç™»å…¥é®ç½©æ¨£å¼ ====== */
        .gate {
            position: fixed;
            inset: 0;
            z-index: 9999;
            background: rgba(0,0,0,0.75);
            display: flex;
            align-items: center;
            justify-content: center;border-radius
        }

        .gate-card {
            width: min(520px, 92vw);
            background: rgba(30,30,30,0.95);
            border: 1px solid var(--border);
            : 16px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,.45);
        }

        .gate h3 {
            margin: 0 0 2px 0; /* ã€é–“è·ã€‘æ¨™é¡Œèˆ‡å‰¯æ¨™çš„è·é›¢ */
            font-size: 16px;
            text-align: center;
        }

        .gate p {
            margin: 1px 0; /* ã€é–“è·ã€‘å‰¯æ¨™èˆ‡è¼¸å…¥å€çš„è·é›¢ */
            color: var(--muted);
            font-size: 14px;
            text-align: center;
        }

        .gate .row {
            margin-top: 12px;
            text-align: center;
        }

            .gate .row label {
                text-align: center;
            }

            .gate .row input {
                display: block;
                margin: 0 auto 7px auto; /* ã€é–“è·ã€‘è¼¸å…¥æ¡†èˆ‡ã€Œé¡¯ç¤ºå¯†ç¢¼ã€çš„è·é›¢ */
                text-align: center;
                max-width: 320px;
            }

        .gate .error {
            text-align: center;
            display: none;
        }

        .gate-actions {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 5px; /* ã€é–“è·ã€‘ç¢ºå®šæŒ‰éˆ•èˆ‡ä¸Šæ–¹çš„è·é›¢ */
        }
    </style>
</head>
<body>
    <div class="gate" id="passGate">
        <div class="gate-card">
            <h3>è¼¸å…¥å¯†ç¢¼å¾Œå³å¯å¡«å¯«</h3>
            <p>è«‹å‘äººè³‡æ‰¿è¾¦ç´¢å–å¯†ç¢¼ğŸ”</p>
            <div class="row">
                <label for="gatePwd">è«‹è¼¸å…¥é‡‘é‘°ğŸ”‘</label>
                <input id="gatePwd" type="password" placeholder="è«‹è¼¸å…¥ä½ çš„å››ä½æ•¸ç”Ÿæ—¥" />
                <button type="button" id="togglePwdVisibility">é¡¯ç¤ºå¯†ç¢¼</button>
                <div class="error" id="gatePwdErr">âŒ å¯†ç¢¼éŒ¯èª¤ï¼Œè«‹å†è©¦ä¸€æ¬¡</div>
            </div>
            <div class="gate-actions">
                <button class="btn" id="gatePwdStart" type="button">ç¢ºå®š</button>
            </div>
        </div>
    </div>

    <form class="container" id="mainForm" role="region" aria-label="å‹å ±å»ºæª”è¡¨ åˆ†æ­¥è¡¨å–®" data-scheme="black" onsubmit="return false;">
        <header class="header">
            <div class="header-title">ğŸ“‘ å‹å ±å»ºæª”è¡¨</div>
            <div class="header-step" id="headerStep">ç¬¬01é /å…±07é </div>
        </header>

        <main class="content" id="content">
            <section class="step active" data-page="1" id="step-1">
                <h2> ã€€ã€€â° æ³¨æ„äº‹é …</h2>
                <ol class="note-list">
                    <li>æ­¤è¡¨å–®åƒ…é™éŒ„å–è€…ä½¿ç”¨.</li>
                    <li>è‹¥éä¸Šè¿°èº«åˆ†è«‹ç«‹å³é€€å‡ºæ­¤è¡¨å–®.</li>
                    <li>è«‹ä¾ç…§ä¸‹åˆ—è¡¨å–®é †åºåŸ·è¡Œå¡«å¯«.</li>
                    <li>ä¸Šå‚³ä¹‹å€‹äººè³‡æ–™æ‚‰ä¾å€‹è³‡ç›¸é—œæ³•ä»¤è¦ç¯„è¾¦ç†ä¿å­˜.</li>
                    <li>å¡«å¯«è¡¨å–®è‹¥é‡åˆ°å›°é›£è«‹å‘å ±åˆ°ç¾¤çµ„æå‡ºç¦®è²Œè©¢å•.</li>
                    <li>è‹¥å°è¡¨å–®æœ‰ç–‘å•ä¸ç¢ºå®šè³‡è¨Š,è«‹å…ˆè©¢å•å¾Œå†å¡«å¯«.</li>
                </ol>

                <div class="fieldset center-block">
                    <div class="fz-note" style="font-weight:800;">æ˜¯å¦äº†è§£ä¸Šè¿°æ³¨æ„äº‹é …</div>
                    <div class="radio-row fz-note" role="radiogroup" aria-label="æ˜¯å¦äº†è§£ä¸Šè¿°æ³¨æ„äº‹é …">
                        <label class="fz-note"><input type="radio" name="agree1" value="yes"> äº†è§£</label>
                        <label class="fz-note"><input type="radio" name="agree1" value="no"> æœ‰ç•°è­°</label>
                    </div>
                    <div class="exit fz-xs" id="exitMsg1">ğŸš¨ è‹¥æœ‰ç–‘å•ï¼Œå¯è©¢å•äººè³‡æ‰¿è¾¦</div>

                </div>
            </section>

        <section class="step" data-page="2" id="step-2">
                <h2>ğŸ“„ å“¡å·¥åŸºæœ¬è³‡æ–™-1</h2>
                <div class="row">
                    <label for="company">Â© å…¬å¸åç¨± <small>â è«‹ç¢ºèªå¾Œå†è¡Œé»é¸</small></label>
                    <select id="company" name="company">
                        <option value="" selected disabled>è«‹é¸æ“‡</option>
                        <option>Drunk Caffee çˆ›é†‰å’–å•¡</option>
                        <option>FIZZ FIZZ.TEIPEI</option>
                        <option>Social Company æœ‰è¶£äººé¡ç¤¾äº¤å±€</option>
                    </select>        
                </div>
          
                <div class="row">
                    <label for="team">Â© éš¸å±¬åœ˜éšŠ <small>â è‹¥ä¸ç¢ºå®šåœ˜éšŠ,è«‹è©¢å•é¢è©¦ä¸»ç®¡å¾Œå†è¡Œé»é¸</small></label>
                    <select id="team" name="team">
                        <option value="" selected disabled>è«‹é¸æ“‡</option>
                        <option>å¤–å ´-Serve Teams</option>
                        <option>å§æª¯-Bar Teams</option>
                        <option>å…§å»š-Kitchen Teams</option>
                        <option>æ”¶éŠ€-Cashier Teams</option>
                        <option>å…¬é—œ-Public Relations Teams</option>
                        <option>å…¶ä»–-Other</option>
                    </select>
                </div>
          
                <div class="row">
                    <label for="workType">Â© å·¥ä½œå‹æ…‹ <small>â è‹¥ä¸ç¢ºå®šå‹æ…‹,è«‹è©¢å•é¢è©¦ä¸»ç®¡å¾Œå†è¡Œé»é¸</small></label>
                    <select id="workType" name="workType">
                        <option value="" selected disabled>è«‹é¸æ“‡</option>
                        <option>æ­£è·/å…¨æ™‚å·¥æ™‚-Full Time</option>
                        <option>å…¼è·/éƒ¨åˆ†å·¥æ™‚-Part Time</option>
                    </select>
                </div>

                <div class="row">
                    <label for="gmail">Â© Gmail <small>â é™å®šGmail,è«‹å¡«å¯«å¸¸ç”¨ä¿¡ç®±,å¯„ç™¼å‹å ±å–®ç”¨</small></label>
                    <input id="gmail" type="email" placeholder="è«‹è¼¸å…¥mail" />
                    <div class="error" id="errGmail">âš ï¸ è«‹è¼¸å…¥æœ‰æ•ˆGmail</div>
                </div>

                <div class="row">
                    <label for="fullName">Â© æœ¬å</label>
                    <input id="fullName" name="fullName" type="text" placeholder="è«‹è¼¸å…¥æœ¬å" />
                    <div class="error" id="errFullName">âš ï¸ æ­¤æ¬„ä½ä¸å¾—ç‚ºç©º</div>
                </div>

                <div class="row">
                    <label for="gender">Â© æ€§åˆ¥ <small>â ä»¥èº«åˆ†è­‰ç‚ºä¸»</small></label>
                    <select id="gender" name="gender">
                        <option value="" selected disabled>è«‹é¸æ“‡</option>
                        <option>ç”·</option>
                        <option>å¥³</option>
                        <option>å¤šå…ƒ</option>
                    </select>
                </div>
            </section>

                <section class="step" data-page="3" id="step-3">
                <h2>ğŸ“„ å“¡å·¥åŸºæœ¬è³‡æ–™-2</h2>
                   <div class="row">
                   <label for="nid">Â© èº«åˆ†è­‰å­—è™Ÿ <small>â å…±è¨ˆ10ç¢¼</small></label>
                   <input id="nid" type="text" placeholder="ç¯„ä¾‹ â˜›A123456789" />
                   <div class="error" id="errNid">âš ï¸ æ ¼å¼æˆ–å¡«å¯«éŒ¯èª¤</div>
                </div>
          
                <div class="row">
                   <label for="birthRoc7">Â© æ°‘åœ‹å‡ºç”Ÿå¹´æœˆæ—¥ <small>â è«‹ä»¥yyyMMddæ ¼å¼å¡«å¯«,å…±7ç¢¼</small></label>
                   <input id="birthRoc7" type="text" placeholder="ç¯„ä¾‹ â˜›1121008æˆ–0750819" />
                   <div class="error" id="errBirthRoc7">âš ï¸ æ ¼å¼é ˆç‚º7ç¢¼,yyyMMdd</div>
                </div>
                     
                <div class="row">
                   <label for="mobile">Â© æ‰‹æ©Ÿé›»è©± <small>â è«‹ä»¥09xx-xxx-xxxæ ¼å¼å¡«å¯«</small></label>
                   <input id="mobile" type="text" placeholder="ç¯„ä¾‹ â˜›0912-345-647" />
                   <div class="error" id="errMobile">âš ï¸ æ ¼å¼éŒ¯èª¤</div>
                </div

                 <div class="row">
                    <label for="birthPlace">Â© å‡ºç”Ÿåœ° <small>â å¯æŸ¥çœ‹èº«åˆ†è­‰èƒŒé¢</small></label>
                    <input id="birthPlace" type="text" placeholder="è«‹è¼¸å…¥å‡ºç”Ÿåœ°" />
                </div>

                <div class="row">
                    <label for="addrHouse">Â© æˆ¶ç±åœ°å€ <small>â å¯æŸ¥çœ‹èº«åˆ†è­‰èƒŒé¢,åŒ…å«é‡ŒåŠé„°éƒ½é ˆå¡«å¯«</small></label>
                    <input id="addrHouse" type="text" placeholder="è«‹è¼¸å…¥æˆ¶ç±åœ°å€" />
                </div>
                    
                <div class="row">
                    <label for="addrLive">Â© å±…ä½åœ°å€ <small>â å‹¿å¡«å¯«åŒæˆ¶ç±åœ°</small></label>
                    <input id="addrLive" type="text" placeholder="è«‹è¼¸å…¥å±…ä½åœ°å€" />
                </div>
                    </section>
          
            <section class="step" data-page="4" id="step-4">
                <h2> ã€€ã€€â« ä¸Šå‚³æª”æ¡ˆ</h2>
                <ol class="note-list">
                    <li>ä¸Šå‚³ä¹‹å€‹äººæº–å‚™æ–‡ä»¶.</li>
                    <li>æœ‰æ­£ç¢ºåŠéŒ¯èª¤ç¯„ä¾‹.</li>
                    <li>æª”æ¡ˆé ˆç¬¦åˆæœ¬å…¬å¸é™å®šè¦æ ¼.</li>
                    <li>å“€é³³æ‰‹æ©Ÿè«‹ç”¨æ‰‹æ©Ÿå…§å»ºå‚™å¿˜éŒ„æƒæ.</li>
                </ol>

                <div class="samples" aria-label="èº«åˆ†è­‰ç¯„æœ¬">

                    <figure class="sample-box">
                        <video class="sample-img" controls playsinline style="max-height:220px; width:100%; object-fit:contain;">
                            <source src="assets/iosæƒæç¯„ä¾‹.mp4" type="video/mp4">
                            âŒ ä½ /å¦³çš„è£ç½®ä¸æ”¯æ´å½±ç‰‡æ’­æ”¾
                        </video>
                        <figcaption class="sample-cap">ğŸ“¹ iPhoneå‚™å¿˜éŒ„æƒææ–‡ä»¶æ“ä½œç¤ºç¯„</figcaption>
                    </figure>

                    <figure class="sample-box">
                        <img class="sample-img" src="assets/èº«åˆ†è­‰ç¯„æœ¬-æ­£é¢.jpg" alt="â—ï¸ç¯„ä¾‹-èº«åˆ†è­‰ä¸Šå‚³é™å®šè¦æ ¼-æ­£é¢"">
                        <figcaption class="sample-cap">âœ… æ­£ç¢ºç¯„ä¾‹-èº«åˆ†è­‰ä¸Šå‚³é™å®šè¦æ ¼-æ­£é¢</figcaption>
                    </figure>
                    <figure class="sample-box">
                        <img class="sample-img" src="assets/èº«åˆ†è­‰ç¯„æœ¬-èƒŒé¢.png" alt="â—ï¸ç¯„ä¾‹-èº«åˆ†è­‰ä¸Šå‚³é™å®šè¦æ ¼-èƒŒé¢">
                        <figcaption class="sample-cap">âœ… æ­£ç¢ºç¯„ä¾‹-èº«åˆ†è­‰ä¸Šå‚³é™å®šè¦æ ¼-èƒŒé¢</figcaption>
                    </figure>
                    <figure class="sample-box">
                        <img class="sample-img" src="assets/è–ªé…¬éŠ€è¡Œç¯„æœ¬.jpg" alt="â—ï¸ç¯„ä¾‹-è–ªé…¬éŠ€è¡Œç¯„æœ¬">
                        <figcaption class="sample-cap">âœ… æ­£ç¢ºç¯„ä¾‹-é ˜å–è–ªé…¬éŠ€è¡Œ-å­˜æ‘ºå°é¢</figcaption>
                    </figure>
                    <figure class="sample-box">
                        <img class="sample-img" src="assets/æˆ¶é ­éŒ¯èª¤ç¯„ä¾‹.jpg" alt="â—ï¸æˆ¶é ­éŒ¯èª¤ç¯„ä¾‹">
                        <figcaption class="sample-cap">âŒ éŒ¯èª¤ç¯„ä¾‹-æ ¼å¼æ²’éŒ¯ä½†è¦ç›´è§€å¯çœ‹æ˜ç™½</figcaption>
                    </figure>
                    <figure class="sample-box">
                        <img class="sample-img" src="assets/è­‰ä»¶éŒ¯èª¤ç¯„ä¾‹-1.jpg" alt="â—ï¸è­‰ä»¶éŒ¯èª¤ç¯„ä¾‹-1">
                        <figcaption class="sample-cap">âŒ éŒ¯èª¤ç¯„ä¾‹-å››è§’æœªå°å››å€‹è§’</figcaption>
                    </figure>
                    <figure class="sample-box">
                        <img class="sample-img" src="assets/è­‰ä»¶éŒ¯èª¤ç¯„ä¾‹-2.jpg" alt="â—ï¸è­‰ä»¶éŒ¯èª¤ç¯„ä¾‹-2">
                        <figcaption class="sample-cap">âŒ éŒ¯èª¤ç¯„ä¾‹-å››è§’æœªå°å››å€‹è§’ä¸”æœ‰å°æ‰‹å…¥é¡</figcaption>
                    </figure>
                </div>

                <div class="fieldset center-block">
                    <div class="fz-note" style="font-weight:800;">æ˜¯å¦åŒæ„ä¸Šè¿°äº‹é …</div>
                    <div class="radio-row fz-note" role="radiogroup" aria-label="æ˜¯å¦åŒæ„ä¸Šè¿°äº‹é …">
                        <label class="fz-note"><input type="radio" name="agreeUpload" value="yes"> åŒæ„</label>
                        <label class="fz-note"><input type="radio" name="agreeUpload" value="no"> ä¸åŒæ„</label>
                    </div>
                    <div class="exit fz-xs" id="errAgreeUpload" style="text-align:center;">âš ï¸ éœ€åŒæ„æ‰èƒ½ç¹¼çºŒå¡«å¯«</div>
                </div>
            </section>

            <section class="step" data-page="5" id="step-5">
                <div class="file-row">
                    <div>Â©ä¸Šå‚³å€-èº«åˆ†è­‰-æ­£é¢</div>
                    <label class="file-input">
                        <span class="file-btn">é¸æ“‡æª”æ¡ˆ</span>
                        <input id="idFront" name="idFront" type="file" accept=".pdf,image/*" />
                    </label>
                    <div class="file-name" id="nameFront">
                        <img class="thumb" id="thumbFront" alt="ç¸®åœ–é è¦½"><span id="nameFrontTxt">å°šæœªé¸å–æª”æ¡ˆ</span>
                    </div>
                </div>

                <div class="file-row">
                    <div>Â©ä¸Šå‚³å€-èº«åˆ†è­‰-èƒŒé¢</div>
                    <label class="file-input">
                        <span class="file-btn">é¸æ“‡æª”æ¡ˆ</span>
                        <input id="idLaborCheck" name="idLaborCheck" type="file" accept=".pdf,image/*" />
                    </label>
                    <div class="file-name" id="nameLaborCheck">
                        <img class="thumb" id="thumbLaborCheck" alt="ç¸®åœ–é è¦½"><span id="nameLaborCheckTxt">å°šæœªé¸å–æª”æ¡ˆ</span>
                    </div>
                </div>

                <div class="file-row">
                    <div>Â©ä¸Šå‚³å€-åŒ¯æ¬¾å­˜æ‘º</div>
                    <label class="file-input">
                        <span class="file-btn">é¸æ“‡æª”æ¡ˆ</span>
                        <input id="idFoodCheck" name="idFoodCheck" type="file" accept=".pdf,image/*" />
                    </label>
                    <div class="file-name" id="nameFoodCheck">
                        <img class="thumb" id="thumbFoodCheck" alt="ç¸®åœ–é è¦½"><span id="nameFoodCheckTxt">å°šæœªé¸å–æª”æ¡ˆ</span>
                    </div>
                </div>

                <div class="fieldset">
                    <div class="checks">
                        <label><input type="checkbox" id="fileChk1"> 1. æ–‡ä»¶æ¸…æ™°ä¸”ç„¡åå…‰</label>
                        <label><input type="checkbox" id="fileChk2"> 2. æ–‡ä»¶å››é‚Šå®Œæ•´å…¥é¡</label>
                        <label><input type="checkbox" id="fileChk3"> 3. æ–‡ä»¶ã€Œå®Œæ•´ã€å°æº–åœ¨æ¡†æ¡†å…§</label>
                        <label><input type="checkbox" id="fileChk4"> 4. ä¸Šè¿°éƒ½å·²ç¢ºèªå®Œæˆå‹•ä½œ</label>
                    </div>
                    <div class="note-list" style="margin-left:0;">
                        ğŸ“£ å¦‚é ˆä¸Šå‚³PDFæª”ï¼Œè«‹å…ˆè½‰æˆJPGæª”å¾Œå†ä¸Šå‚³
                    </div>
                </div>
            </section>

            <section class="step" data-page="6" id="step-6">
                <h2>â—ï¸è³‡æ–™é€å‡ºå‰-æ ¸æª¢å€</h2>
                <div class="fieldset">
                    <div class="checks">
                        <label><input type="checkbox" id="preA"> 1. ä»¥ä¸Šè¼¸å…¥è³‡æ–™éƒ½é€²è¡Œé›™é‡ç¢ºèª.</label>
                        <label><input type="checkbox" id="preB"> 2. æœ¬äººè²æ˜ç„¡å½é€ ä¹‹ä¸æ³•æƒ…å½¢.</label>
                        <label><input type="checkbox" id="preC"> 3. ä¸Šå‚³æª”æ¡ˆéƒ½ç¬¦åˆæœ¬å…¬å¸æ ¼å¼.</label>
                        <label><input type="checkbox" id="preD"> 4. è«‹ä»”ç´°æ€è€ƒèªçœŸå¡«å¯«æ­¤è¡¨å–®.</label>
                        <label><input type="checkbox" id="preE"> 5. ç¢ºèªå¡«å¯«è³‡æ–™æ­£ç¢ºå†æäº¤,æäº¤å¾Œç„¡æ³•æ›´æ”¹.</label>
                        <label><input type="checkbox" id="preF"> 6. æäº¤è¡¨å–®å¾Œ,è«‹å®Œæˆæˆªåœ–å›å ±æ©Ÿåˆ¶.</label>
                    </div>
                </div>
                <div class="right-actions" style="display:flex; gap:10px; justify-content:center; position:relative; bottom:0">
                    <button class="btn btn--nav fz-xs" id="btnSubmit" type="button" disabled>æäº¤</button>
                </div>
            </section>

            <section class="step" data-page="7" id="step-7">
                <h2>âœ… å…¨æ•¸å®Œæˆ</h2>
                <div class="fz-xs" style="text-align:center; line-height:1.8;">
                    Â© å‹å ±å»ºæª”è¡¨
                    <hr style="border:0;border-top:1px solid var(--border);margin:10px 0;">
                    <div>â—ï¸è«‹æˆªåœ–æ­¤ç•«é¢çµ¦æ‰¿è¾¦äºº</div>
                    <hr style="border:0;border-top:1px solid var(--border);margin:10px 0;">
                    <div>ç³»çµ±å·²æ”¶åˆ°è³‡æ–™ï¼Œå°‡é€²å…¥è™•ç†æ’ç¨‹</div>
                    <div style="margin-top:10px;color:var(--muted);font-size:11px;">
                        å»ºç«‹æ™‚é–“ï¼š<span id="stampCreated">â€”</span>ã€€æäº¤æ™‚é–“ï¼š<span id="stampUpdated">â€”</span>
                    </div>
                </div>
            </section>
        </main>

        <div class="actionbar" id="actionbar">
            <div class="left-actions">
                <button class="btn btn--nav" id="btnPrev" type="button">ä¸Šä¸€é </button>
            </div>
            <div class="right-actions" style="display:flex; gap:12px;">
                <button class="btn btn--nav" id="btnNext" type="button">ä¸‹ä¸€é </button>
            </div>
        </div>

        <footer class="footer" id="footer">
            <img src="assets/MYs_logo_å»èƒŒ.png" alt="MYs Logo" class="footer-logo">
            ï¸³Â© Copyright 2025 MYs System-b1.0.22-11/25~11/28
        </footer>
    </form>

<script>
/* --------ç³»çµ±å¸¸æ•¸-------- */
const TOTAL_STEPS = 7;
/* â˜…â˜…â˜… è«‹ç¢ºèªæ­¤è™• GAS ç¶²å€æ˜¯å¦ç‚ºæœ€æ–° â˜…â˜…â˜… */
const GAS_URL = "https://script.google.com/macros/s/AKfycbzh52JEiM6kXZXuqcbl9odP--vIZZLAeMbirH7BgW6mnSA2p0PELGJh4yITXJz1ahbA/exec";

const $  = (sel) => document.querySelector(sel);
const $$ = (sel) => document.querySelectorAll(sel);

/* è¡¨å–®æ™‚é–“æˆ³ */
const FORM_META = { createdAt: null, updatedAt: null };
function fmtTW(d){
  try{
    return new Intl.DateTimeFormat('zh-TW',{year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit',second:'2-digit',hour12:false,timeZone:'Asia/Taipei'}).format(d);
  }catch(e){ return d.toLocaleString(); }
}
function setCreatedNow(){ if(!FORM_META.createdAt){ FORM_META.createdAt = new Date(); updateStampUI(); } }
function setUpdatedNow(){ FORM_META.updatedAt = new Date(); updateStampUI(); }
function updateStampUI(){
  const c = $("#stampCreated"), u = $("#stampUpdated");
  if(c){ c.textContent = FORM_META.createdAt ? fmtTW(FORM_META.createdAt) : "â€”"; }
  if(u){ u.textContent = FORM_META.updatedAt ? fmtTW(FORM_META.updatedAt) : "â€”"; }
}

/* ====== å¯†ç¢¼é€²å…¥é®ç½© ====== */
const PASSWORDS = ["MYsDC404", "MYsFZ404", "MYsSC404", "0404"];
(function passGateInit(){
  const gate = $("#passGate"), pwd = $("#gatePwd"), btn = $("#gatePwdStart"), err = $("#gatePwdErr");
  const togglePwdButton = $("#togglePwdVisibility");
  if (!gate) return;

  let isPasswordVisible = false;
  togglePwdButton.addEventListener("click", () => {
    isPasswordVisible = !isPasswordVisible;
    pwd.type = isPasswordVisible ? "text" : "password";
    togglePwdButton.textContent = isPasswordVisible ? "éš±è—å¯†ç¢¼" : "é¡¯ç¤ºå¯†ç¢¼";
  });

  err.style.display = "none";
  btn.addEventListener("click", () => {
    const v = (pwd.value || "").trim().toLowerCase();
    const isValid = PASSWORDS.some(p => p.toLowerCase() === v);
    if (!isValid) { err.style.display = "block"; return; }
    err.style.display = "none";
    gate.style.display = "none";
    setCreatedNow();
    autoFitActionbarHeight();
  });
})();

/* ====== æª”æ¡ˆè½‰ Base64 ====== */
function fileToBase64(file) {
    return new Promise((resolve, reject) => {
        if(!file) { resolve(null); return; }
        const reader = new FileReader();
        reader.readAsDataURL(file);
        reader.onload = () => {
            const base64 = reader.result.split(',')[1];
            resolve({ name: file.name, mimeType: file.type, base64: base64 });
        };
        reader.onerror = error => reject(error);
    });
}

/* ====== æäº¤è³‡æ–™ (å‹å ±å»ºæª”) ====== */
async function submitData() {
    const btn = $("#btnSubmit");
    if (!btn) return;

    const originalText = btn.textContent;
    btn.textContent = "â³ è³‡æ–™å‚³é€ä¸­ï¼Œè«‹ç¨å¾Œï¼Œè«‹å‹¿é€€å‡ºæ­¤ä»‹é¢";
    btn.disabled = true;

    const payload = {
        formType: "laborReport", /* ç¢ºä¿å¾Œç«¯çŸ¥é“é€™æ˜¯å‹å ± */
        createdAt: FORM_META.createdAt ? fmtTW(FORM_META.createdAt) : '',
        company:   $("#company").value,
        team:      $("#team").value,
        workType:  $("#workType").value,
        gmail:     $("#gmail").value,
        fullName:  $("#fullName").value,
        gender:    $("#gender").value,
        nid:       $("#nid").value,
        birthRoc7: $("#birthRoc7").value,
        mobile:    $("#mobile").value,
        birthPlace:$("#birthPlace").value,
        addrHouse: $("#addrHouse").value,
        addrLive:  $("#addrLive").value,
        fileFront: null, 
        fileBack: null, 
        fileBank: null
    };

    try {
        /* å°æ‡‰ HTML çš„ ID (è«‹ç¢ºèªæ‚¨çš„ HTML ID æ˜¯å¦ç‚º idFront, idLaborCheck, idFoodCheck) */
        /* å‚™è¨»ï¼šå› ç‚ºå¾Œç«¯ handleLaborReport æœŸå¾… fileFront, fileBack, fileBank */
        /* é€™è£¡å°‡ HTML çš„ç¬¬2ã€3å€‹æª”æ¡ˆæ¬„ä½å°æ‡‰éå» */
        const f1 = $("#idFront").files[0];
        const f2 = $("#idLaborCheck").files[0]; // å°æ‡‰åˆ° fileBack (èº«åˆ†è­‰åé¢)
        const f3 = $("#idFoodCheck").files[0];  // å°æ‡‰åˆ° fileBank (éŠ€è¡Œå­˜æ‘º)

        if (f1) payload.fileFront = await fileToBase64(f1);
        if (f2) payload.fileBack  = await fileToBase64(f2);
        if (f3) payload.fileBank  = await fileToBase64(f3);

        const response = await fetch(GAS_URL, {
            method: "POST",
            body: JSON.stringify(payload)
        });
        const res = await response.json();

        if (res.status === 'ok') {
            showStep(7); /* æˆåŠŸ -> è·³è‡³å®Œæˆé  */
        } else {
            alert("âŒ " + (res.status === 'duplicate' ? "ä½ /å¦³å·²ç¶“å¡«å¯«é..." : "éŒ¯èª¤: " + res.message));
            btn.textContent = originalText;
            btn.disabled = false;
        }
    } catch (err) {
        alert("âš ï¸ å‚³é€å¤±æ•—ï¼Œè«‹è¯ç¹«äººè³‡æ‰¿è¾¦");
        console.error(err);
        btn.textContent = originalText;
        btn.disabled = false;
    }
}

/* ====== éµç›¤èˆ‡ç¸®æ”¾ï¼ˆiOSï¼‰ ====== */
(function keyboardLift(){
  const vv = window.visualViewport;
  if(!vv) return;
  function apply(){
    const bottomInset = (window.innerHeight - vv.height - vv.offsetTop);
    document.documentElement.style.setProperty('--kv-offset', bottomInset>0 ? `${bottomInset}px` : '0px');
    if(bottomInset > 80){ document.body.classList.add('kb-open'); }
    else { document.body.classList.remove('kb-open'); }
    autoFitActionbarHeight();
  }
  vv.addEventListener('resize', apply);
  vv.addEventListener('scroll', apply);
  window.addEventListener('resize', apply);
  apply();
})();

(function focusAutoScroll(){
  document.addEventListener('focusin', (e)=>{
    const el = e.target;
    if(!(el instanceof HTMLInputElement) && !(el instanceof HTMLSelectElement)) return;
    setTimeout(()=>{ el.scrollIntoView({ block: 'center', behavior: 'smooth' }); }, 50);
  });
})();

/* ====== é©—è­‰å·¥å…· ====== */
let currentPage = 1;
let IS_LOCKED = false;
function pad2(n){ return String(n).padStart(2,'0'); }
function pageIsPurple(n){ return [1, 7].includes(n); }
    
/* æŒ‡å®šé ç‚ºç´«è‰²ï¼š1, 4 ï¼›å…¶é¤˜é»‘è‰² */
function pageIsPurple(n) { return [1, 4,].includes(n); }
    
function updateHeaderStep(){
  $("#headerStep").textContent = `ç¬¬${pad2(currentPage)}é /å…±${pad2(TOTAL_STEPS)}é `;
  const scheme = pageIsPurple(currentPage) ? "purple" : "black";
  $(".container").setAttribute("data-scheme", scheme);
}

function lockAllAndHideNav(){
  IS_LOCKED = true;
  document.querySelectorAll('input, select, button, textarea').forEach(el=>{ el.disabled = true; });
  const prev=$("#btnPrev"), next=$("#btnNext");
  if(prev){ prev.style.display="none"; }
  if(next){ next.style.display="none"; }
}

function showStep(pageNumber){
  if(IS_LOCKED && pageNumber!==TOTAL_STEPS) return;
  $$(".step").forEach(s=>s.classList.remove("active"));
  const el = document.getElementById(`step-${pageNumber}`);
  if(el) el.classList.add("active");
  currentPage = pageNumber;
  updateHeaderStep();
  $("#content").scrollTo({ top: 0, behavior: "instant" });
  updateNavState();

  if(pageNumber===TOTAL_STEPS){
    setUpdatedNow();
    setTimeout(()=>{ lockAllAndHideNav(); updateNavState(); }, 0);
  }
}

function bindFilePreview(inputId, txtId, thumbId) {
    const input = $(inputId);
    const txt = $(txtId);
    const thumb = $(thumbId);
    input?.addEventListener("change", () => {
        const file = input.files[0];
        if (!file) {
            txt.textContent = "å°šæœªé¸å–æª”æ¡ˆ";
            thumb.style.display = "none"; thumb.src = "";
            return;
        }
        txt.textContent = file.name;
        if (file.type === "application/pdf") {
            thumb.src = "https://upload.wikimedia.org/wikipedia/commons/8/87/PDF_file_icon.svg";
            thumb.style.display = "block";
            return;
        }
        const reader = new FileReader();
        reader.onload = (e) => {
            thumb.src = e.target.result;
            thumb.style.display = "block";
        };
        reader.readAsDataURL(file);
    });
}
bindFilePreview("#idFront", "#nameFrontTxt", "#thumbFront");
bindFilePreview("#idLaborCheck", "#nameLaborCheckTxt", "#thumbLaborCheck");
bindFilePreview("#idFoodCheck", "#nameFoodCheckTxt", "#thumbFoodCheck");

function validatePage(n) {
    switch (n) {
        case 1: return !!$('input[name="agree1"][value="yes"]')?.checked;
        case 2: {
            const a = $("#company").value !== "";
            const b = $("#team").value !== "";
            const c = $("#workType").value !== "";
            const d = $("#gmail").value.includes("@gmail.com");
            const e = $("#fullName").value.trim() !== "";
            const f = $("#gender").value !== "";
            return a && b && c && d && e && f;
        }
        case 3: {
            const a = /^[A-Z][0-9]{9}$/.test($("#nid").value.toUpperCase());
            const b = /^\d{7}$/.test($("#birthRoc7").value);
            const c = /^09\d{2}-\d{3}-\d{3}$/.test($("#mobile").value);
            const d = $("#birthPlace").value.trim() !== "";
            const e = $("#addrHouse").value.trim() !== "";
            const f = $("#addrLive").value.trim() !== "";
            return a && b && c && d && e && f;
        }
        case 4: return $(`input[name="agreeUpload"][value="yes"]`).checked;
        case 5: {
            const f1 = $("#idFront").files.length > 0;
            const f2 = $("#idLaborCheck").files.length > 0;
            const f3 = $("#idFoodCheck").files.length > 0;
            const checks = ["#fileChk1", "#fileChk2", "#fileChk3", "#fileChk4"].every(id => $(id).checked);
            return f1 && f2 && f3 && checks;
        }
        case 6: return ["#preA", "#preB", "#preC", "#preD", "#preE", "#preF"].every(id => $(id).checked);
        case 7: return true;
    }
    return false;
}

function updateNavState() {
    const btnPrev = $("#btnPrev"), btnNext = $("#btnNext");
    const onLast = currentPage === TOTAL_STEPS;
    const isValid = validatePage(currentPage);

    if (btnPrev) {
        /* ç¬¬1é ä¸é¡¯ç¤ºä¸Šä¸€é  */
        if (currentPage <= 1 || onLast) {
            btnPrev.style.display = "none";
        } else {
            btnPrev.style.display = "inline-block";
            btnPrev.disabled = IS_LOCKED;
        }
    }

    if (btnNext) {
        if (currentPage === 6 || onLast) {
            btnNext.style.display = "none"; 
        } else {
            btnNext.style.display = isValid ? "inline-block" : "none";
        }
    }

    if (currentPage === 6) {
        const btnSubmit = $("#btnSubmit");
        if (btnSubmit) btnSubmit.disabled = !isValid;
    }
}

function bindLiveValidation() {
    $$('input, select').forEach(el => {
        el.addEventListener('change', () => updateNavState());
        el.addEventListener('input', () => updateNavState());
    });
    
    const mailInput = $("#gmail");
    if (mailInput) {
        mailInput.addEventListener('blur', (e) => {
            const isValid = e.target.value.includes("@gmail.com");
            $("#errGmail").style.display = isValid ? "none" : "block";
        });
        mailInput.addEventListener('input', (e) => {
            const val = e.target.value;
            if (val.endsWith('@') && !val.includes('@gmail.com')) { e.target.value = val + 'gmail.com'; }
            const isValid = e.target.value.includes("@gmail.com");
            if($("#errGmail").style.display === "block" && isValid) $("#errGmail").style.display = "none";
            updateNavState();
        });
    }

    const nidInput = $("#nid");
    if (nidInput) {
        nidInput.addEventListener('blur', (e) => {
            const isValid = /^[A-Z][0-9]{9}$/.test(e.target.value);
            $("#errNid").style.display = isValid ? "none" : "block";
        });
        nidInput.addEventListener('input', (e) => {
            e.target.value = e.target.value.toUpperCase();
            const isValid = /^[A-Z][0-9]{9}$/.test(e.target.value);
            if($("#errNid").style.display === "block" && isValid) $("#errNid").style.display = "none";
            updateNavState();
        });
    }

    const birthInput = $("#birthRoc7");
    if (birthInput) {
        birthInput.addEventListener('blur', (e) => {
            const isValid = /^\d{7}$/.test(e.target.value);
            $("#errBirthRoc7").style.display = isValid ? "none" : "block";
        });
        birthInput.addEventListener('input', (e) => {
            const isValid = /^\d{7}$/.test(e.target.value);
            if($("#errBirthRoc7").style.display === "block" && isValid) $("#errBirthRoc7").style.display = "none";
            updateNavState();
        });
    }

    const mobileInput = $("#mobile");
    if (mobileInput) {
        mobileInput.addEventListener('blur', (e) => {
            const isValid = /^09\d{2}-\d{3}-\d{3}$/.test(e.target.value);
            $("#errMobile").style.display = isValid ? "none" : "block";
        });
        mobileInput.addEventListener('input', (e) => {
            const isValid = /^09\d{2}-\d{3}-\d{3}$/.test(e.target.value);
            if($("#errMobile").style.display === "block" && isValid) $("#errMobile").style.display = "none";
            updateNavState();
        });
    }

    $$('input[name="agreeUpload"]').forEach(r => {
        r.addEventListener('change', (e) => {
            const isNo = e.target.value === "no";
            $("#errAgreeUpload").style.display = isNo ? "block" : "none";
            updateNavState();
        });
    });

    $$('input[name="agree1"]').forEach(r => {
        r.addEventListener('change', (e) => {
            const isNo = e.target.value === "no";
            $("#exitMsg1").classList.toggle("show", isNo);
            updateNavState();
        });
    });

    $("#btnSubmit")?.addEventListener("click", () => { submitData(); });
}

function autoFitActionbarHeight() {
    const bar = $("#actionbar"); if (!bar) return;
    document.documentElement.style.setProperty('--actionbar-h', `${bar.offsetHeight}px`);
}
(function observeBar() {
    const bar = $("#actionbar");
    if (!bar || !('ResizeObserver' in window)) return;
    const ro = new ResizeObserver(() => autoFitActionbarHeight());
    ro.observe(bar);
})();

function bindActionBar() {
    $("#btnPrev").addEventListener("click", () => {
        if (!IS_LOCKED && currentPage > 1) {
            showStep(currentPage - 1);
        }
    });

    $("#btnNext").addEventListener("click", () => {
        if (IS_LOCKED) return;
        const ok = validatePage(currentPage);
        if (ok && currentPage < TOTAL_STEPS) {
            setUpdatedNow();
            showStep(currentPage + 1);
        }
    });
}

document.addEventListener("DOMContentLoaded", () => {
    showStep(1);
    bindLiveValidation();
    bindActionBar();
    autoFitActionbarHeight();
    updateStampUI();
});
</script>
</body>
</html>
